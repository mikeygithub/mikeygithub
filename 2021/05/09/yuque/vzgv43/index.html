

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <meta name="referrer" content="no-referrer"/>
  <link rel="apple-touch-icon" sizes="76x76" href="https://cdn.jsdelivr.net/gh/mikeygithub/jsDeliver@master/resource/img/favicon.png">
  <link rel="icon" href="https://cdn.jsdelivr.net/gh/mikeygithub/jsDeliver@master/resource/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Mikey">
  <meta name="keywords" content="">
  
  <title>调优篇-Linux性能调优 - 麦奇</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->

  
<link rel="stylesheet" href="/css/custom.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"mikeygithub.github.io","root":"/","version":"1.8.10","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":200}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":"74301a15e5497361e93588eeee69f4b2","google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="麦奇" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>麦奇</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/photo/">
                <i class="iconfont icon-image"></i>
                照片
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/todo/">
                <i class="iconfont icon-plan"></i>
                代办
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/music/">
                <i class="iconfont icon-music"></i>
                音乐
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/atom.xml">
                <i class="iconfont icon-rss"></i>
                RSS
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-briefcase"></i>
                其他
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" target="_blank" rel="noopener" href="https://www.yuque.com/aichihongdouheyumi/blog">
                    
                    在线创作
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/about/">
                    
                    关于麦奇
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('https://bing.ioliu.cn/v1/rand') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="调优篇-Linux性能调优">
              
            </span>

            
              <div class="mt-3">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-author" aria-hidden="true"></i>
      Mikey
    </span>
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-05-09 17:24" pubdate>
        2021年5月9日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      2.3k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      33
       分钟
    </span>
  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">调优篇-Linux性能调优</h1>
            
            <div class="markdown-body">
              <h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><blockquote>
<p>出于学习项目主管去 POC 所写的调优复盘总结，记录一些自己通过学习该文档学习到的相关知识．</p>
</blockquote>
<h1 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h1><h2 id="hdparm-查看硬度读取速度"><a href="#hdparm-查看硬度读取速度" class="headerlink" title="hdparm 查看硬度读取速度"></a>hdparm 查看硬度读取速度</h2><figure class="highlight vbnet"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs vbnet">hdparm - <span class="hljs-keyword">get</span>/<span class="hljs-keyword">set</span> hard disk parameters - version v9.<span class="hljs-number">54</span>, <span class="hljs-keyword">by</span> Mark Lord.<br><br>clue=<span class="hljs-number">6</span><br><span class="hljs-symbol">Usage:</span>  hdparm  [options] [device ...]<br><br><span class="hljs-symbol">Options:</span><br> -a   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> fs readahead<br> -A   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> the drive look-ahead flag (<span class="hljs-number">0</span>/<span class="hljs-number">1</span>)<br> -b   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> bus state (<span class="hljs-number">0</span> == <span class="hljs-keyword">off</span>, <span class="hljs-number">1</span> == <span class="hljs-keyword">on</span>, <span class="hljs-number">2</span> == tristate)<br> -B   <span class="hljs-keyword">Set</span> Advanced Power Management setting (<span class="hljs-number">1</span>-<span class="hljs-number">255</span>)<br> -c   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> IDE <span class="hljs-number">32</span>-bit IO setting<br> -C   Check drive power mode status<br> -d   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> using_dma flag<br> -D   Enable/disable drive defect management<br> -E   <span class="hljs-keyword">Set</span> cd/dvd drive speed<br> -f   Flush buffer cache <span class="hljs-keyword">for</span> device <span class="hljs-keyword">on</span> <span class="hljs-keyword">exit</span><br> -F   Flush drive write cache<br> -g   Display drive geometry<br> -h   Display terse usage information<br> -H   Read temperature <span class="hljs-keyword">from</span> drive (Hitachi only)<br> -i   Display drive identification<br> -I   Detailed/current information directly <span class="hljs-keyword">from</span> drive<br> -J   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> Western DIgital <span class="hljs-string">&quot;Idle3&quot;</span> timeout <span class="hljs-keyword">for</span> a WDC <span class="hljs-string">&quot;Green&quot;</span> drive (DANGEROUS)<br> -k   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> keep_settings_over_reset flag (<span class="hljs-number">0</span>/<span class="hljs-number">1</span>)<br> -K   <span class="hljs-keyword">Set</span> drive keep_features_over_reset flag (<span class="hljs-number">0</span>/<span class="hljs-number">1</span>)<br> -L   <span class="hljs-keyword">Set</span> drive doorlock (<span class="hljs-number">0</span>/<span class="hljs-number">1</span>) (removable harddisks only)<br> -m   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> multiple sector count<br> -M   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> acoustic management (<span class="hljs-number">0</span>-<span class="hljs-number">254</span>, <span class="hljs-number">128</span>: quiet, <span class="hljs-number">254</span>: fast)<br> -n   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> ignore-write-errors flag (<span class="hljs-number">0</span>/<span class="hljs-number">1</span>)<br> -N   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> max visible number <span class="hljs-keyword">of</span> sectors (HPA) (VERY DANGEROUS)<br> -p   <span class="hljs-keyword">Set</span> PIO mode <span class="hljs-keyword">on</span> IDE <span class="hljs-keyword">interface</span> chipset (<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,...)<br> -P   <span class="hljs-keyword">Set</span> drive prefetch count<br> -q   Change <span class="hljs-keyword">next</span> setting quietly<br> -Q   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> DMA queue_depth (<span class="hljs-keyword">if</span> supported)<br> -r   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> device <span class="hljs-keyword">readonly</span> flag (DANGEROUS <span class="hljs-keyword">to</span> <span class="hljs-keyword">set</span>)<br> -R   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> device write-read-verify flag<br> -s   <span class="hljs-keyword">Set</span> power-up <span class="hljs-keyword">in</span> standby flag (<span class="hljs-number">0</span>/<span class="hljs-number">1</span>) (DANGEROUS)<br> -S   <span class="hljs-keyword">Set</span> standby (spindown) timeout<br> -t   Perform device read timings<br> -T   Perform cache read timings<br> -u   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> unmaskirq flag (<span class="hljs-number">0</span>/<span class="hljs-number">1</span>)<br> -U   Obsolete<br> -v   Use defaults; same <span class="hljs-keyword">as</span> -acdgkmur <span class="hljs-keyword">for</span> IDE drives<br> -V   Display program version <span class="hljs-built_in">and</span> <span class="hljs-keyword">exit</span> immediately<br> -w   Perform device reset (DANGEROUS)<br> -W   <span class="hljs-keyword">Get</span>/<span class="hljs-keyword">set</span> drive write-caching flag (<span class="hljs-number">0</span>/<span class="hljs-number">1</span>)<br> -x   Obsolete<br> -X   <span class="hljs-keyword">Set</span> IDE xfer mode (DANGEROUS)<br> -y   Put drive <span class="hljs-keyword">in</span> standby mode<br> -Y   Put drive <span class="hljs-keyword">to</span> sleep<br> -z   Re-read partition table<br> -Z   Disable Seagate <span class="hljs-keyword">auto</span>-powersaving mode<br> --dco-freeze      Freeze/lock current device configuration <span class="hljs-keyword">until</span> <span class="hljs-keyword">next</span> power cycle<br> --dco-identify    Read/dump device configuration identify data<br> --dco-restore     Reset device configuration back <span class="hljs-keyword">to</span> factory defaults<br> --dco-setmax      Use DCO <span class="hljs-keyword">to</span> <span class="hljs-keyword">set</span> maximum addressable sectors<br> --direct          Use O_DIRECT <span class="hljs-keyword">to</span> bypass page cache <span class="hljs-keyword">for</span> timings<br> --drq-hsm-<span class="hljs-keyword">error</span>   Crash system <span class="hljs-keyword">with</span> a <span class="hljs-string">&quot;stuck DRQ&quot;</span> <span class="hljs-keyword">error</span> (VERY DANGEROUS)<br> --fallocate       Create a file without writing data <span class="hljs-keyword">to</span> disk<br> --fibmap          Show device extents (<span class="hljs-built_in">and</span> fragmentation) <span class="hljs-keyword">for</span> a file<br> --fwdownload            Download firmware file <span class="hljs-keyword">to</span> drive (EXTREMELY DANGEROUS)<br> --fwdownload-mode3      Download firmware <span class="hljs-keyword">using</span> min-size segments (EXTREMELY DANGEROUS)<br> --fwdownload-mode3-max  Download firmware <span class="hljs-keyword">using</span> max-size segments (EXTREMELY DANGEROUS)<br> --fwdownload-mode7      Download firmware <span class="hljs-keyword">using</span> a <span class="hljs-type">single</span> segment (EXTREMELY DANGEROUS)<br> --fwdownload-modee      Download firmware <span class="hljs-keyword">using</span> mode E (min-size segments) (EXTREMELY DANGEROUS)<br> --fwdownload-modee-max  Download firmware <span class="hljs-keyword">using</span> mode E (max-size segments) (EXTREMELY DANGEROUS)<br> --idle-immediate  Idle drive immediately<br> --idle-unload     Idle immediately <span class="hljs-built_in">and</span> unload heads<br> --Istdin          Read identify data <span class="hljs-keyword">from</span> stdin <span class="hljs-keyword">as</span> ASCII hex<br> --Istdout         Write identify data <span class="hljs-keyword">to</span> stdout <span class="hljs-keyword">as</span> ASCII hex<br> --make-bad-sector Deliberately corrupt a sector directly <span class="hljs-keyword">on</span> the media (VERY DANGEROUS)<br> --offset          use <span class="hljs-keyword">with</span> -t, <span class="hljs-keyword">to</span> begin timings at given offset (<span class="hljs-keyword">in</span> GiB) <span class="hljs-keyword">from</span> start <span class="hljs-keyword">of</span> drive<br> --prefer-ata12    Use <span class="hljs-number">12</span>-<span class="hljs-type">byte</span> (instead <span class="hljs-keyword">of</span> <span class="hljs-number">16</span>-<span class="hljs-type">byte</span>) SAT commands <span class="hljs-keyword">when</span> possible<br> --read-sector     Read <span class="hljs-built_in">and</span> dump (<span class="hljs-keyword">in</span> hex) a sector directly <span class="hljs-keyword">from</span> the media<br> --repair-sector   <span class="hljs-keyword">Alias</span> <span class="hljs-keyword">for</span> the --write-sector <span class="hljs-keyword">option</span> (VERY DANGEROUS)<br> --sanitize-antifreeze-lock  Block sanitize-freeze-lock command <span class="hljs-keyword">until</span> <span class="hljs-keyword">next</span> power cycle<br> --sanitize-block-<span class="hljs-keyword">erase</span>      Start block <span class="hljs-keyword">erase</span> operation<br> --sanitize-crypto-scramble  Change the internal encryption keys that used <span class="hljs-keyword">for</span> used data<br> --sanitize-freeze-lock      Lock drive<span class="hljs-comment">&#x27;s sanitize features until next power cycle</span><br> --sanitize-overwrite  PATTERN  Overwrite the internal media <span class="hljs-keyword">with</span> constant PATTERN<br> --sanitize-status           Show sanitize status information<br> --security-help             Display help <span class="hljs-keyword">for</span> ATA security commands<br> --trim-sector-ranges        Tell SSD firmware <span class="hljs-keyword">to</span> discard unneeded data sectors: lba:count ..<br> --trim-sector-ranges-stdin  Same <span class="hljs-keyword">as</span> above, but reads lba:count pairs <span class="hljs-keyword">from</span> stdin<br> --verbose                   Display extra diagnostics <span class="hljs-keyword">from</span> some commands<br> --write-sector              Repair/overwrite a (possibly bad) sector directly <span class="hljs-keyword">on</span> the media (VERY DANGEROUS)<br></code></pre></div></td></tr></table></figure>

<p>常见用法</p>
<figure class="highlight nix"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nix"><span class="hljs-comment">#先使用df -h查看该机器挂载了哪些硬盘</span><br>df -h<br><span class="hljs-comment">#查看</span><br>sudo hdparm /dev/sda<br><span class="hljs-comment">#显示如下信息</span><br>/dev/sda:<br> <span class="hljs-attr">multcount</span>     =  <span class="hljs-number">0</span> (off)<br> <span class="hljs-attr">IO_support</span>    =  <span class="hljs-number">1</span> (<span class="hljs-number">32</span>-bit)<br> <span class="hljs-attr">readonly</span>      =  <span class="hljs-number">0</span> (off)<br> <span class="hljs-attr">readahead</span>     = <span class="hljs-number">256</span> (on)<br> <span class="hljs-attr">geometry</span>      = <span class="hljs-number">19929</span>［柱面数］/<span class="hljs-number">255</span>［磁头数］/<span class="hljs-number">63</span>［扇区数］, <span class="hljs-attr">sectors</span> = <span class="hljs-number">320173056</span>［总扇区数］, <span class="hljs-attr">start</span> = <span class="hljs-number">0</span>［起始扇区数］<br></code></pre></div></td></tr></table></figure>

<p>​</p>
<p><a target="_blank" rel="noopener" href="https://www.linuxcool.com/">命令</a>：hdparm -t /dev/sda5 打印：Timing buffered disk reads: 254 MB in 3.01 seconds = 84.34 MB/sec 说明：能够指定具体的哪块硬盘进行查询的哦！<br><strong>2,iostat 检测磁盘 IO 情况：</strong><br>格式：iostat [ -c | -d ] [ -k ] [ -t ] [ -V ] [ -x [ device ] ] [ interval ] 描述：iostat 是 I/O statistics（输入/输出统计）的缩写，iostat 工具将对系统的磁盘操作活动进行监视。它的特点是汇报磁盘活动统计情况，同时也会汇报出 CPU 使用情况，同 vmstat 一样，iostat 也有一个弱点，就是它不能对某个进程进行深入分析，仅对系统的整体情况进行分析，每 1 秒检测统计一次（共 5 次）。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/2630542/1625582227076-cf7ea062-6d7a-42ac-b3d0-38b00480dde6.png#clientId=u8ff3f033-b03a-4&from=paste&id=u766d6c92&margin=%5Bobject%20Object%5D&originHeight=142&originWidth=727&originalType=url%E2%88%B6=1&status=done&style=none&taskId=u542986c0-9f58-4794-b0fd-6e73599e1ba" srcset="/img/loading.gif" lazyload><br>blk_read/s 每秒读取的数据块数<br>blk_wrtn/s 每秒写入的数据块数<br>blk_read 表示读取的所有数据块数<br>blk_wrtn 表示写入的所有数据块数<br><strong>3,vmstat 报告内存以及 CPU 状况：</strong><br>名称：报告虚拟内存的统计信息 格式：vmstat [-n] [延时[次数]]<br><img src="https://cdn.nlark.com/yuque/0/2021/png/2630542/1625582227033-11946dc5-155f-49ce-809d-869ba4d4631d.png#clientId=u8ff3f033-b03a-4&from=paste&id=u66d151fc&margin=%5Bobject%20Object%5D&originHeight=81&originWidth=725&originalType=url%E2%88%B6=1&status=done&style=none&taskId=uf47d814a-86b8-4dbd-b0e7-781aadaf50a" srcset="/img/loading.gif" lazyload></p>
<table>
<thead>
<tr>
<th>R:</th>
<th>运行和等待 CPU 时间片的进程数。长期大于 CPU 的个数，代表 CPU 不足</th>
</tr>
</thead>
<tbody><tr>
<td>B：</td>
<td>等待资源的进程数，如果等待数量多，问题有可能处在 I/O 或者内存</td>
</tr>
<tr>
<td>Swpd:</td>
<td>切换到内存交换区的内存大小[以 KB 为单位]</td>
</tr>
<tr>
<td>free:</td>
<td>当前空闲的物理内存数量[以 KB 为单位]</td>
</tr>
<tr>
<td>si:</td>
<td>由磁盘调入内存</td>
</tr>
<tr>
<td>so:</td>
<td>由内存调入磁盘</td>
</tr>
<tr>
<td>bi:</td>
<td>从块设备读入数据的总量</td>
</tr>
<tr>
<td>bo:</td>
<td>写到块设备的数据总量</td>
</tr>
<tr>
<td>bi+bo</td>
<td>1000 如果超过 1000，代表硬盘的读写速度有问题</td>
</tr>
<tr>
<td>in:</td>
<td>在某一时间间隔内观测到的每秒设备中断数[中断数太多对性能不好]</td>
</tr>
<tr>
<td>cs:</td>
<td>列表示每秒产生的上下文切换次数</td>
</tr>
<tr>
<td>us+sy &gt; 80%</td>
<td>代表 CPU 资源不足</td>
</tr>
<tr>
<td>us:</td>
<td>用户进程消耗的 CPU 时间百分比</td>
</tr>
<tr>
<td>sy:</td>
<td>内核进程消耗的 CPU 时间百分比</td>
</tr>
<tr>
<td>id:</td>
<td>CPU 处在空闲状态的时间百分比</td>
</tr>
<tr>
<td>wa:</td>
<td>IO 等待所占用的时间百分比</td>
</tr>
<tr>
<td>runq-sz:</td>
<td>内存中可以运行的进程数</td>
</tr>
<tr>
<td>plist-sz:</td>
<td>系统中活跃的任务个数</td>
</tr>
</tbody></table>
<p>​</p>
<p><strong>4,sar 检测 CPU 资源：</strong><br>任务计划 /etc/cron.d/sysstat 日志目录 /var/log/sa 查看方法 Sar –q –f /var/log/sa/sa10<br><img src="https://cdn.nlark.com/yuque/0/2021/png/2630542/1625582227056-81a3acee-2066-4762-85fc-a4f6b94ab05d.png#clientId=u8ff3f033-b03a-4&from=paste&id=u8acd8666&margin=%5Bobject%20Object%5D&originHeight=386&originWidth=723&originalType=url%E2%88%B6=1&status=done&style=none&taskId=u282534af-366a-4ca4-9d86-c2c0a9f698e" srcset="/img/loading.gif" lazyload><br><strong>5,lscpu 显示 CPU 信息：</strong><br>dmesg 显示出开机启动的信息 lscpu 显示 CPU 信息 lscpu -p 显示 CPU 对应的节点数 getconf LONG<em>BIT 获知主机的位数 getconf -a 查看全部的参数 /sys/class/dmi/id 可以查看 Bios 的信息 bios</em>*<br><strong>6,strace 显示程序的调用：</strong><br>strace –fc elinks –dump <a target="_blank" rel="noopener" href="http://localhost/">http://localhost</a><br><strong>7,调优硬盘优先写入/读取数据用：</strong><br><img src="https://cdn.nlark.com/yuque/0/2021/png/2630542/1625582227216-c85b16e2-fa04-4bab-b4c6-61910a8231e6.png#clientId=u8ff3f033-b03a-4&from=paste&id=uc52e5db7&margin=%5Bobject%20Object%5D&originHeight=144&originWidth=581&originalType=url%E2%88%B6=1&status=done&style=none&taskId=u587df758-dadd-474b-9191-3847aa9b45c" srcset="/img/loading.gif" lazyload><br>预先读取需要写入的量，然后再处理写请求，↑ 读到的值将会是设置值的一半 ↑。<br>设置读取到缓存中的数值越大.写入时就会因为数据量大而速度变慢。<br>/sys/block/sda/queue/nr_requests 队列长度越大,硬盘 IO 速度会提升,但占用内存<br>/sys/block/sda/queue/scheduler 调度算法 Noop、anticipatory、deadline、[cfq]<br>​</p>
<p><strong>8,将 Ext3 文件系统的日志功能独立：</strong><br>1、创建 200M 的/dev/sdb1 格式化为 ext3 2、dumpe2fs /dev/sdb1 查看文件系统功能中包含的 has_journal 3、Tune2fs –O ^has_journal /dev/sdb1 去掉默认原有的日志功能 4、再分一个 200M 的分区./dev/sdb2. 日志卷的 block 必须等于 /dev/sdb1 Mke2fs –O journal_dev –b 1024 /dev/sdb2 5、将/dev/sdb2 作为/dev/sdb1 的日志卷. Tune2fs –j –J device=/dev/sdb2 /dev/sdb1<br><strong>9,关闭记录文件系统 atime：</strong><br>对于网站文件，频繁的修改 atime 是没有意义的，会影响性能 mount –o remount,noatime DEVICE 即可<br><strong>10、修改文件日志的提交时间：</strong><br>默认是 5 秒提交一次日志，修改更长时间可以提高性能，但容易丢失数据。 mount –o remount,commit=15 DEVICE<br><strong>11,RAID 轮循写入调优,适用于 0/5/6：</strong><br>chunk size.轮循一次写入的字节.默认是 64K,只要没有写满，就不会移动到下一个设备<br>设置在每个硬盘都只写一个文件就切换到下一块硬盘,那么如果都是 1K 的小文件，就会将系统资源浪费在切换硬盘上<br>如果将 chunk size 的值设置很大，比如 100M,那么也就没有了意义，还不如用一块硬盘。<br>Stripe size.条带大小，并不是有数据就写入,而是设置每次写入的数据量，一般是 16K 写一次。<br>所以.Chunk size(64K)/stripe size(16K)，也就是说每块硬盘写四次。<br>————————————算当前应该把 chunk size 调成多少————————————<br>使用 iostat –x 查看自开机以来每秒的平均请求数 avgrq-sz<br>chunk size = 每秒请求数*512/1024/磁盘数，取一个最紧接 2 倍数的整数<br>stride = chunk size /block(默认是 4k)<br>创建 raid 并设置 chunk sinze<br>mdadm –C /dev/md0 –l 0 –n3 –chunk=8 /dev/sdb[123]<br>修改 raid<br>mke2fs –j –b 4096 –E stride=2 /dev/md0<br><strong>12,硬盘的 block 保留数：</strong><br>dumpe2fs /dev/sda1 tune2fs –m 10 /dev/sda1 保留 block 百分比 tune2fs –r 保留 block 数 保留的 block 过少,影响性能,保留的过多又浪费硬盘,默认是 5%<br><strong>学习了上面的性能调优</strong><a target="_blank" rel="noopener" href="https://www.linuxcool.com/">命令</a><strong>和方法后，再总结几条调优的金句：</strong><br>独立设备性能速度比集成的强，因为不占用主机整体资源<br>工程师一般不会远程管理计算机，需要提供日志等信息<br>硬盘空间越大，读取的速度越慢，可以考虑用多块硬盘组成一块较大空间<br>分区只是在硬盘上做标识,而不像格式化在做文件系统特性,所以速度快<br>硬盘越靠外侧速度越快[分区号越小越靠外区,所以将数据量大的首先分区].<br>程序开发者注重雇主的功能要求，系统管理员注重程序的资源开销</p>
<h1 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h1><p>盘点 linux 系统中的 12 条性能调优命令: <a target="_blank" rel="noopener" href="https://www.linuxprobe.com/linux-performance-tuning.html">https://www.linuxprobe.com/linux-performance-tuning.html</a><br>一般 Linux 性能调优都用什么工具: <a target="_blank" rel="noopener" href="https://www.zhihu.com/question/448362493/answer/1770329163">https://www.zhihu.com/question/448362493/answer/1770329163</a></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/">性能调优</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/Linux/">Linux</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2021/05/09/yuque/cfsl38/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">中间件-Redis学习笔记</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/05/07/java/Java%E7%AF%87-JProflie%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/">
                        <span class="hidden-mobile">Java篇-JProflie性能分析</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      var light = 'github-light';
      var dark = 'github-dark';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'mikeygithub/commit-utterance');
      s.setAttribute('issue-term', 'pathname');
      
      s.setAttribute('label', 'utterances');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->

  <div class="col-lg-7 mx-auto nopadding-x-md">
    <div class="container custom post-custom mx-auto">
      <img src="https://octodex.github.com/images/jetpacktocat.png" srcset="/img/loading.gif" lazyload class="rounded mx-auto d-block mt-5" style="width:150px; height:150px;">
    </div>
  </div>


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     Copyright © 2017-2021 麦奇 Powered by <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> And <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> Core on Github Page 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


  
  <!-- 备案信息 -->
  <div class="beian">
    <span>
      <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
        桂ICP备2020009931号-1
      </a>
    </span>
    
      
        <span>
          <a
            href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=2020009931"
            rel="nofollow noopener"
            class="beian-police"
            target="_blank"
          >
            
              <span style="visibility: hidden; width: 0">|</span>
              <img src="/img/police_beian.png" srcset="/img/loading.gif" lazyload alt="police-icon"/>
            
            <span>桂公网安备2020009931号</span>
          </a>
        </span>
      
    
  </div>


  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":200})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      $('#local-search-input').on('click', function() {
        searchFunc(path, 'local-search-input', 'local-search-result');
      });
      $('#modalSearch').on('shown.bs.modal', function() {
        $('#local-search-input').focus();
      });
    })()
  </script>





  

  
    <!-- MathJax -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        options: {
          renderActions: {
            findScript: [10, doc => {
              document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
                const display = !!node.type.match(/; *mode=display/);
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                const text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = { node: text, delim: '', n: 0 };
                math.end = { node: text, delim: '', n: 0 };
                doc.math.push(math);
              });
            }, '', false],
            insertedScript: [200, () => {
              document.querySelectorAll('mjx-container').forEach(node => {
                let target = node.parentNode;
                if (target.nodeName.toLowerCase() === 'li') {
                  target.parentNode.classList.add('has-jax');
                }
              });
            }, '', false]
          }
        }
      };
    </script>

    <script async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-svg.js" ></script>

  





  <script  src="https://cdn.jsdelivr.net/npm/mermaid@8.8.3/dist/mermaid.min.js" ></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize({"theme":"default"});
    }
  </script>




  
    <!-- Baidu Analytics -->
    <script defer>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?74301a15e5497361e93588eeee69f4b2";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  

  

  

  

  





<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
